<ion-page>
  <ion-content class="user-dashboard-content">
    <div class="header">
      <div class="back-button">
      </div>
    </div>

    <div class="search-section">
      <div class="search-container">
        <div class="search-icon">
          <ion-icon name="search-outline"></ion-icon>
        </div>
        <input
          type="text"
          class="search-input"
          placeholder="Search counsellors by name"
          [(ngModel)]="searchQuery"
          (input)="handleSearch()"
        />
      </div>
    </div>

    <div class="main-content">
      <div class="counsellors-list" *ngIf="filteredCounsellors.length; else emptyState">
        <div *ngFor="let counsellor of filteredCounsellors" class="counsellor-card" (click)="viewCounsellorProfile(counsellor)">
          <div class="card-content">
            <div class="counsellor-info">
              <div class="counsellor-details">
                <div
                  class="status-indicator"
                  [ngClass]="{
                    'status-online': counsellor.is_active,
                    'status-offline': !counsellor.is_active
                  }"
                >
                  <div class="status-dot"></div>
                  <span>{{ counsellor.is_active ? 'Online' : 'Offline' }}</span>
                </div>
                <h3 class="counsellor-name">{{ counsellor.name }}</h3>
                <p class="counsellor-specialty">
                  {{ counsellor.qualification || 'General Counseling' }}.
                  {{ counsellor.experience }} years of experience.
                </p>
                <div class="rating-container">
                  <div class="stars">
                    <ion-icon name="star"></ion-icon>
                    <ion-icon name="star"></ion-icon>
                    <ion-icon name="star"></ion-icon>
                    <ion-icon name="star"></ion-icon>
                    <ion-icon name="star-half-outline"></ion-icon>
                  </div>
                </div>
              </div>
              <div class="action-buttons">
                <button
                  class="btn btn-primary"
                  (click)="bookCounsellor(counsellor)"
                >
                  <ion-icon name="call-outline"></ion-icon>
                  Call
                </button>
              </div>
            </div>
            <div class="profile-photo-container">
              <div class="profile-photo">
                <img *ngIf="counsellor.profile_photo" [src]="getProfilePhotoSrc(counsellor.profile_photo)" alt="Counsellor Profile Photo" class="counsellor-img">
                <span *ngIf="!counsellor.profile_photo">{{
                  counsellor.name.charAt(0) | uppercase
                }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <ng-template #emptyState>
        <div class="empty-state">
          <div class="empty-icon">
            <ion-icon name="sad-outline"></ion-icon>
          </div>
          <p>No counsellors found matching your criteria.</p>
        </div>
      </ng-template>
    </div>
  </ion-content>
  <ion-footer class="ion-no-border main-footer" slot="bottom">
    <ion-toolbar>
      <app-home-footer></app-home-footer>
    </ion-toolbar>
  </ion-footer>
</ion-page>